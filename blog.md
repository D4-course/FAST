# Fusion models for Atomic and molecular STructures (FAST) TEAM 17 PROJECT 2


### Problem Statement

Predicting accurate protein-ligand binding affinity is important in drug discovery.
Predicting accurate protein−ligand binding affinities is an
computationally expensive biophysics-based energy scoring methods and
application of deep convolutional and graph neural network-based
approach are and how they compare with physics-based methodologies that
We use temporal and structure-based splits to assess performance on novel protein targets. 
applicability of our models, we examine their performance in cases that assume that the crystal structure is not available. 
cases, binding free energies are predicted using docking pose coordinates as the inputs to each model. 
deep learning approaches to predictions based on docking scores and molecular mechanic/generalized Born surface area (MM/
Our results show that the fusion models make more accurate predictions than their constituent neural network
models as well as docking scoring and MM/GBSA rescoring, with the benefit of greater computational efficiency than the MM/. 
Predicting accurate binding affinity between a small molecule
Recently, deep learning models have been
The benefit of the deep learning
approach is in learning binding interaction rules directly from
an atomic representation without relying on hand-curated
Two types of three-dimensional (3D)-structure-based deep
prediction,5 uses a 3D voxel representation of atoms.

### Solution proposed

Feature Extraction. A common atomic representation was
used for input to the 3D-structure-based deep learning models.
We considered only the heavy atoms from each biological
structure and heteroatoms (e.g., oxygens from crystallized
water molecules).
- Element type: one-hot encoding of B, C, N, O, P, S, Se,
halogen, or metal.
- Atom hybridization (1, 2, or 3).
- Number of heavy atom bonds (i.e., heavy valence).
- Number of bonds with other heteroatoms
Structural properties: bit vector (1 where present)
encoding of hydrophobic, aromatic, acceptor, donor,
ring.
- Partial charge.
- Molecule type to indicate protein atom versus ligand
atom (−1 for protein, 1 for ligand).
- Van der Waals radius.

![](./img/Screenshot%20from%202022-12-01%2000-32-19.png)


### Architechture 

![](./img/Screenshot%20from%202022-12-01%2000-58-28.png)

### 3D CNN

Binding affinity prediction and other protein−ligand interactions in the drug discovery domain. 5,12,26−28 These methods
interactions using 3D volume representations, where atoms
and their features are voxelized into the 3D voxel grid.
The 3D atomic representation used in this paper is
× N × C, where N is the voxel grid size in each axis and C is
the number of atomic features described in the previous
section (19 in our experiment).
on multiple voxel grid sizes of 32, 48, and 64 in each axis, we
in each dimension is approximately 48 Å, where each voxel size
collisions between atoms, we apply element-wise addition to
the atom features.

![](data:image/png;base64,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)

Once all atoms are voxelized, Gaussian blur
with σ = 1 is applied to populate the atom features into
CNN-based models.
augmentation for the 3D atomic representations does not show.


### SG-CNN

![](data:image/jpeg;base64,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)

Graph-based deep learning approaches have
considers atoms as nodes and bonds as edges between the
capture noncovalent interactions that are necessary to model
more complex biological structures (e. g. , atomic interactions
based on euclidean distance, effectively relaxing the covalency
requirement to form edges in the graph representation of a
edge types and applies a node information-propagation
technique based on gated graph sequence neural networks34
to allow the deep learning model to learn noncovalent
interaction information in the 2D graph representation.
We adopt the spatial graph representation3 for the molecular
as the nodes within this graph representation.


thresholds for covalent and noncovalent “neighborness”, αc
We found that these settings lead to the best
performance on the validation set.

### Fusion model

![](https://scx2.b-cdn.net/gfx/news/2021/new-medical-image-fusi.jpg)


Fusion models to combine multiple input sources
or different feature representations have been applied to a
Proposed midlevel fusion model together with 3D-CNN and SG-CNN.
These fusion models benefit from multiple feature representations which are considered complementary.
combine feature representations from two independently
trained models (3D-CNN and SG-CNN), each of which has
proposed fusion model`s features, potentially improving the
best of our knowledge, this fusion model is the first attempt to
combine multiple heterogeneous 3D model representations for
The proposed midlevel fusion model that
combines features from 3D-CNN and SG-CNN.
features in the fusion model, we use the second- and fourth-last
fully connected layer, and the outputs are concatenated with
the original input features for cross-layer connections, before
the next fully connected layer.


concatenation outperformed addition and the model without
fusion structures: (1) addition instead of concatenation of
features, (2) different numbers of activations in the fully
observed that the proposed fusion with concatenation
outperformed the other models for the task of protein−ligand
Discussing different layer structures.

## Results

<center>

![](./img/Screenshot%20from%202022-12-01%2001-17-05.png)
![](./img/Screenshot%20from%202022-12-01%2001-17-14.png)
![](./img/Screenshot%20from%202022-12-01%2001-17-28.png)
![](./img/Screenshot%20from%202022-12-01%2001-17-36.png)
![](./img/Screenshot%20from%202022-12-01%2001-17-53.png)

</center>


## Getting Started With Code


### Prerequisites

- [PyTorch 1.4 or higher](https://pytorch.org)
- [PyTorch Geometric Feature)](https://github.com/rusty1s/pytorch_geometric)
- [rdkit](rdkit.org) (optional)
- [pybel](https://github.com/pybel/pybel)  (optional)
- [pdbfixer](https://github.com/openmm/pdbfixer)  (optional)
- [tfbio](https://gitlab.com/cheminfIBB/tfbio)  (optional)


### Running the application

#### Data format

The implemented networks use a 3D atomic representation as input data in a Hierarchical Data Format (HDF5). 
Each complex/pocket data is comprised of a list of atoms with their features including 3D coordinates of the atoms (x, y, z) and associated features such as atomic number and charges. For more detail, please refer to the paper in the Citing LIST section.  


#### 3D-CNN

Note that the original 3D-CNN implementation used in the paper below has been moved to 3dcnn_tf. A new version using pytorch has been released in `model/3dcnn`


##### 3D-CNN tensorflow version (used in the paper)

To train or test 3D-CNN, run `model/3dcnn_tf/main_3dcnn_pdbbind.py`. 
Here is an example comand to test a pre-trained 3D-CNN model:

```
python main_3dcnn_pdbbind.py --main-dir "pdbbind_3dcnn" --model-subdir "pdbbind2016_refined" --run-mode 5 --external-hdftype 3 --external-testhdf "eval_set.hdf" --external-featprefix "eval_3dcnn" --external-dir "pdbbind_2019"
```

##### 3D-CNN pytorch version (new version)

In this new version, the voxelization process is done on GPU, which improves performance/speed-up. The new version is located in `model/3dcnn`

To train, run `model/3dcnn/main_train.py`
To test/evaluate, run `model/3dcnn/model_eval.py`

example evaluation: 
`python main_eval.py  --data-dir [directory storing data hdf and csv files]  --mlhdf-fn [hdf file name]  --model-path [full path to model checkpoint file (.pth)] --complex-type [1: crystal, 2: docking]`

`python main_eval.py  --data-dir /a/b/c  --mlhdf-fn data_ml.hdf  --model-path d/e/model_3dcnn_01.pth --complex-type 2 --save-pred --save-feat`

Note that `model/3dcnn/data_reader.py` is a default data reader that reads our ML-HDF format described above. Please use your own data_reader to read your own format.


#### SG-CNN

To train or test SG-CNN, run `model/sgcnn/src/train.py` or `model/sgcnn/src/test.py`. 

For an example training script, see `model/sgcnn/scripts/train_pybel_pdbbind_2016_general_refined.sh`


#### Fusion

To train or test fusion model, run `model/fusion/main_fusion_pdbbind.py`

```
python main_fusion_pdbbind.py --main-dir "pdbbind_fusion" --fusionmodel-subdir "pdbbind2016_fusion" --run-mode 3 --external-csvfile "eval_3dcnn.csv" --external-3dcnn-featfile "eval_3dcnn_fc10.npy" --external-sgcnn-featfile "eval_sgcnn_feat.npy" --external-outprefix "eval_fusion" --external-dir "pdbbind_2019"
```

#### Pre-trained weights (checkpoint files)

We trained all of the networks above on [pdbbind 2016 datasets](http://www.pdbbind.org.cn). Particularly, we used general and refined datasets for training and validation, and evaluated the model on the core set (see sample_data/core_test.hdf). 

The checkpoint files for the models are made available under the Creative Commons BY 4.0 license. See the license section below for the terms of the license. The files can be found here: `ftp://gdo-bioinformatics.ucllnl.org/fast/pdbbind2016_model_checkpoints/`. 

Note that the new 3dcnn checkpoint for pytorch (model_checkpoint_3dcnn.tgz) was trained on pdbbind 2019 refined dataset.  


#### PDBSpheres evaluation set

We make available the hold-out test set from the manuscript here: `sample_data/PDBSPHERES_EVAL_SET.csv`


